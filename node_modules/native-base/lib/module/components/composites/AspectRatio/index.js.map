{"version":3,"sources":["index.tsx"],"names":["AspectView","React","forwardRef","props","ref","useState","layout","setLayout","inputStyle","StyleSheet","flatten","style","width","height","push","aspectRatio","inLayout","nativeEvent","AspectRatio","ratio","children","computedStyle","newChildWithProps","cloneElement","absoluteFillObject","Platform","OS","memo"],"mappings":"+bAAA,oDACA,yCACA,iEACA,4D,uIAQA,GAAMA,CAAAA,UAAU,CAAGC,eAAMC,UAAN,CAAiB,SAACC,KAAD,CAAaC,GAAb,CAA2B,qBACjCH,eAAMI,QAAN,EADiC,iEACtDC,MADsD,qBAC9CC,SAD8C,qBAE7D,GAAMC,CAAAA,UAAU,CAAG,CAACC,wBAAWC,OAAX,CAAmBP,KAAK,CAACQ,KAAzB,GAAmC,EAApC,CAAnB,CACA,GAAIL,MAAJ,CAAY,mBAEsBA,MAFtB,CAEJM,KAFI,CAEJA,KAFI,wBAEI,CAFJ,8BAEsBN,MAFtB,CAEOO,MAFP,CAEOA,MAFP,yBAEgB,CAFhB,gBAGV,GAAID,KAAK,GAAK,CAAd,CAAiB,CACfJ,UAAU,CAACM,IAAX,CAAgB,CAAEF,KAAK,CAAEC,MAAM,CAAGV,KAAK,CAACY,WAAxB,CAAqCF,MAAM,CAANA,MAArC,CAAhB,EACD,CAFD,IAEO,CACLL,UAAU,CAACM,IAAX,CAAgB,CAAEF,KAAK,CAALA,KAAF,CAASC,MAAM,CAAED,KAAK,CAAGT,KAAK,CAACY,WAA/B,CAAhB,EACD,CACF,CACD,MACE,8BAAC,YAAD,0BACMZ,KADN,EAEE,GAAG,CAAEC,GAFP,CAGE,KAAK,CAAEI,UAHT,CAIE,QAAQ,CAAE,2BAA0BQ,CAAAA,QAA1B,MAAGC,WAAH,CAAkBX,MAAlB,OACRC,CAAAA,SAAS,CAACS,QAAD,CADD,EAJZ,8EADF,CAUD,CAtBkB,CAAnB,CAwBA,GAAME,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,OAElBd,GAFkB,CAGf,IAFDO,CAAAA,KAEC,OAFDA,KAEC,CAFMQ,KAEN,OAFMA,KAEN,CAFaC,QAEb,OAFaA,QAEb,CAF0BjB,KAE1B,2EACH,GAAIkB,CAAAA,aAAoC,CAAGV,KAA3C,CACA,GAAIW,CAAAA,iBAAiB,CAAGrB,eAAMsB,YAAN,CACtBH,QADsB,0BAGjBA,QAAQ,CAACjB,KAHQ,EAIpBQ,KAAK,CAAEF,wBAAWe,kBAJE,GAMtBJ,QAAQ,CAACjB,KAAT,CAAeiB,QANO,CAAxB,CAQA,GAAIL,CAAAA,WAAW,CAAG,CAAC,oBAAMI,KAAN,CAAD,CAAgBA,KAAhB,CAAwB,EAAI,CAA9C,CAGA,GAAIM,sBAASC,EAAT,GAAgB,KAApB,CAA2B,CACzB,MACE,8BAAC,UAAD,0BAAgBvB,KAAhB,EAAuB,WAAW,CAAEY,WAApC,CAAiD,KAAK,CAAEJ,KAAxD,CAA+D,GAAG,CAAEP,GAApE,8EACGkB,iBADH,CADF,CAKD,CAND,IAMO,CACLD,aAAa,CAAGZ,wBAAWC,OAAX,CAAmB,CAACC,KAAD,CAAQ,CAAEI,WAAW,CAAXA,WAAF,CAAR,CAAnB,CAAhB,CACA,MACE,8BAAC,YAAD,0BAASZ,KAAT,EAAgB,KAAK,CAAEkB,aAAvB,CAAsC,GAAG,CAAEjB,GAA3C,8EACGkB,iBADH,CADF,CAKD,CACF,CA9BD,C,aAgCerB,eAAM0B,IAAN,CAAW1B,eAAMC,UAAN,CAAiBgB,WAAjB,CAAX,C","sourcesContent":["import React from 'react';\nimport { StyleSheet, ViewStyle, Platform } from 'react-native';\nimport { default as Box, IBoxProps } from '../../primitives/Box';\nimport isNil from 'lodash.isnil';\n\nexport type IAspectRatioProps = IBoxProps & {\n  style?: ViewStyle;\n  ratio?: number;\n  children: JSX.Element;\n};\n\nconst AspectView = React.forwardRef((props: any, ref?: any) => {\n  const [layout, setLayout] = React.useState();\n  const inputStyle = [StyleSheet.flatten(props.style) || {}];\n  if (layout) {\n    // @ts-ignore\n    let { width = 0, height = 0 } = layout;\n    if (width === 0) {\n      inputStyle.push({ width: height * props.aspectRatio, height });\n    } else {\n      inputStyle.push({ width, height: width / props.aspectRatio });\n    }\n  }\n  return (\n    <Box\n      {...props}\n      ref={ref}\n      style={inputStyle}\n      onLayout={({ nativeEvent: { layout: inLayout } }: any) =>\n        setLayout(inLayout)\n      }\n    />\n  );\n});\n\nconst AspectRatio = (\n  { style, ratio, children, ...props }: IAspectRatioProps,\n  ref?: any\n) => {\n  let computedStyle: ViewStyle | undefined = style;\n  let newChildWithProps = React.cloneElement(\n    children,\n    {\n      ...children.props,\n      style: StyleSheet.absoluteFillObject,\n    },\n    children.props.children\n  );\n  let aspectRatio = !isNil(ratio) ? ratio : 4 / 3;\n\n  // DOC:  It uses a aspectRatio property of React Native and manually calculate on Web\n  if (Platform.OS === 'web') {\n    return (\n      <AspectView {...props} aspectRatio={aspectRatio} style={style} ref={ref}>\n        {newChildWithProps}\n      </AspectView>\n    );\n  } else {\n    computedStyle = StyleSheet.flatten([style, { aspectRatio }]);\n    return (\n      <Box {...props} style={computedStyle} ref={ref}>\n        {newChildWithProps}\n      </Box>\n    );\n  }\n};\n\nexport default React.memo(React.forwardRef(AspectRatio));\n"]}